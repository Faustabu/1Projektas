#include <iostream>
#include <iomanip>
#include<string>
#include<cmath>
#include<fstream>
#include<vector>
#include<algorithm>
#include<numeric>
#include <stdio.h>      /* printf, scanf, puts, NULL */
#include <stdlib.h>     /* srand, rand */
#include <time.h>  

using std::cin;
using std::cout;
using std::vector;
using std::endl;
using std::string;

struct studentas{
  string vardas, pavarde;
  vector<float> paz = {0};
  float egz;
  float gal;
  };
  

  int random_generatorius()
  {
   // srand(time(NULL));
    int r = rand() % 10 +1;
    return r;
  }

vector<int> auto_skaiciai (int pazymiu_kiekis )
{
vector<int> sk;
for(int i = 0; i<pazymiu_kiekis; i++){
  sk.push_back(random_generatorius());
}
return sk;
}

float galutinis_balas(vector<int>skaiciai)
{
  studentas eile;
  eile.gal = 0.4 * std::accumulate(skaiciai.begin(), skaiciai.end(), 0)/skaiciai.size() + 0.6 * random_generatorius();
  return eile.gal;
}


int generavimas(vector<int> nd_skc){
  int kiek;
  cout<<"iveskite studentu skaiciu: "; cin>>kiek;
  string pavadinimas = "studentai_" + std::to_string(kiek) + ".txt";
  std::ofstream isvedimas(pavadinimas);
  vector<int> skaiciai;
  studentas eile;
  isvedimas<<std::setw(20)<<std::left<<"Vardas"<<std::setw(20)<<std::left<<"Pavarde"<<std::setw(20)<<std::left<<"Gal.(vid)"<<endl;

  for (int i = 1; i <= kiek; i++)
	{
		skaiciai = auto_skaiciai(5);
		isvedimas << std::setw(20) << "Vardas" + std::to_string(i) <<
			std::setw(20) << "Pavarde" + std::to_string(i) <<
			std::setw(18) << galutinis_balas(skaiciai) << std::endl;
		skaiciai.clear();

	}
return kiek;
}


void failo_skaitymas(vector<studentas> & kint, int kiek){
int stud = 0;
std::ifstream skaitymas;
string buff;
string pavadinimas = "studentai_" + std::to_string(kiek) + ".txt";
skaitymas.open(pavadinimas);

if(skaitymas.is_open()){
  getline (skaitymas>> std::ws, buff);
  while(stud < kiek)
{
  kint.resize(kint.size() + 1);

  skaitymas>>kint.at(stud).vardas;
  skaitymas>>kint.at(stud).pavarde;
  skaitymas>>kint.at(stud).gal;
stud +=1;
}

}




}  


int main()
  {
    int paz;
    cout<<"iveskite pazymiu kieki: ";
    cin>>paz;
    float balas = 5.00;
    auto_skaiciai(paz);
vector<int> skaiciai;

	int kiek = generavimas(skaiciai);
  
	vector<studentas> duom;
  failo_skaitymas(duom, kiek);
  vector<studentas> galvociai;
  vector<studentas> nuskriaustukai;
  int galvoc = 0;
  int nuskr = 0;
  string pavad1, pavad2;

pavad1 = "nuskriaustukai_" + std::to_string(kiek) + ".txt";
std::ofstream nuskr_failas(pavad1);

pavad2 = "galvociai_" + std::to_string(kiek) + ".txt";
std::ofstream galvoc_failas(pavad2);

  for (int i = 0; i<kiek; i++){
    if(duom.at(i).gal < balas)
    {
      nuskriaustukai.push_back(duom.at(i));
      
nuskr_failas <<duom.at(i).vardas<<  std::setw(20) << duom.at(i).pavarde << std::setw (20) << duom.at(i).gal<< endl;

nuskr +=1;
    }
    }
  
  for (int j =0; j<kiek; j++) 
    { 
      if(duom.at(j).gal >= balas){
      galvociai.push_back(duom.at(j));
      galvoc_failas <<duom.at(j).vardas<<  std::setw(20) << duom.at(j).pavarde << std::setw (20) << duom.at(j).gal<< endl;
    galvoc +=1;}
    }
    
}
